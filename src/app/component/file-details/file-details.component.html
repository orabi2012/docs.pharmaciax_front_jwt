<div class="container-fluid">
  <nav class="navbar navbar-light navbar-glass navbar-expand-sm">
    <div class="d-flex align-items-center">
      <a class="navbar-brand me-1 me-sm-3" routerLink="/home">
        <button class="btn btn-secondary btn-sm">العودة إلي الصفحة الرئيسية</button>
      </a>
    </div>
    <ul class="navbar-nav navbar-nav-icons ms-auto flex-row align-items-center">
      <li *ngIf="file?.data?.createdBy.id == user.user_id || user.role_id === 1" class="nav-item me-2">
        <button [routerLink]="['/update_file',file?.data?.File_data_id]" class="btn btn-primary btn-sm">تعديل</button>
      </li>
      <li *ngIf="user.role_id === 1" class="nav-item">
        <button type="button" class="btn btn-danger btn-sm" (click)="isModalOpen = true" data-bs-toggle="modal"
          data-bs-target="#exampleModal">حذف</button>
      </li>
    </ul>
  </nav>

  <div class="card mb-3">
    <div class="card-header">
      <div class="col">
        <h5 class="mb-0">كود المستند</h5>
      </div>
    </div>
    <div class="card-body bg-light border-top">
      <p class="mb-0 text-center text-danger">{{file?.data?.File_data_id}}</p>
    </div>
  </div>

  <div class="card mb-3">
    <div class="card-header">
      <div class="row justify-content-between">
        <div class="col-9">
          <h5 class="mb-0">تفاصيل المستند</h5>
        </div>
        <div class="col-3">
          <span class="active-status">Active</span>
        </div>
      </div>
    </div>
    <div class="card-body bg-light border-top">
      <div class="row">
        <div class="col-3">
          <p class="label">إسم المستند</p>
        </div>
        <div class="col-9">
          <p class="value">{{file?.data?.file_name}}</p>
        </div>
      </div>
      <div class="row categories">
        <div class="category-item">
          <div class="col-4">
            <p class="label">التصنيف الرئيسي</p>
          </div>
          <div class="col-8">
            <p class="value">{{file?.data?.Category?.Category_name}}</p>
          </div>
        </div>
        <div class="category-item">
          <div class="col-4">
            <p class="label">التصنيف الفرعي</p>
          </div>
          <div class="col-8">
            <p class="value">{{subObj}}</p>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-3">
          <p class="label">رقم الإصدار</p>
        </div>
        <div class="col-3">
          <p class="value">{{file?.data?.Doc_No}}</p>
        </div>
        <div class="col-3">
          <p class="label">سنة الإصدار</p>
        </div>
        <div class="col-3">
          <p class="value">{{file?.data?.Year}}</p>
        </div>
      </div>
      <div class="row">
        <div class="col-3">
          <p class="label">الدولة</p>
        </div>
        <div class="col-3 d-flex align-items-center">
          <img class="country-flag" [src]="file?.data?.Country?.flag">
          <span class="value">{{file?.data?.Country?.country_name}}</span>
        </div>
        <div class="col-3">
          <p class="label">حالة المستند</p>
        </div>
        <div class="col-3">
          <button class="btn btn-sm status-badge" [ngClass]="{
            'btn-success': file?.data?.file_data_status?.status_name === 'ساري',
            'btn-warning': file?.data?.file_data_status?.status_name === 'قيد المراجعة',
            'btn-danger': file?.data?.file_data_status?.status_name === 'منتهي'
          }">
            {{file?.data?.file_data_status?.status_name}}
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="card mb-3">
    <div class="card-header">
      <div class="row align-items-center">
        <div class="col">
          <h5 class="mb-0">وصف المستند</h5>
        </div>
      </div>
    </div>
    <div class="card-body bg-light border-top">
      <div [innerHTML]="file?.data?.file_desc"></div>
    </div>
  </div>

  <div class="card mb-3">
    <div class="card-header">
      <div class="row align-items-center">
        <div class="col">
          <h5 class="mb-0">صورة المستند</h5>
        </div>
      </div>
    </div>
    <div class="card-body bg-light">
      <ng-container *ngIf="pdfLoading; else pdfContent">
        <div class="text-center">
          <i class="fa fa-spinner fa-spin fa-4x"></i>
          <p>جاري التحميل...</p>
        </div>
      </ng-container>
      <ng-template #pdfContent>
        <object *ngIf="pdfUrl && !pdfLoading" [data]="pdfUrl" type="application/pdf" width="100%"
          [height]="isMobile ? '400px' : '600vh'">
          <div class="text-center">
            <p>يبدو أنه لا يمكن عرض الملف مباشرة.</p>
            <a [href]="pdfUrl" target="_blank" class="btn btn-primary">
              فتح المستند في نافذة جديدة
            </a>
          </div>
        </object>
      </ng-template>
    </div>
  </div>

  <div class="card mb-3">
    <div class="card-body bg-light border-top" dir="ltr">
      <div class="row">
        <div class="col-3">
          <p class="mb-1">Created By:</p>
        </div>
        <div class="col-3 fw-bold">
          {{file?.data?.createdBy?.first_name}} {{file?.data?.createdBy?.last_name}}
        </div>
        <div class="col-3">
          <p class="mb-1">Created At:</p>
        </div>
        <div class="col-3 fw-bold">
          {{datePipe.transform(file?.data?.createdAt, 'dd/MM/yyyy')}}
        </div>
      </div>

      <div class="row">
        <div class="col-3">
          <p class="mb-1">Updated By:</p>
        </div>
        <div class="col-3 fw-bold">
          {{file?.data?.updatedBy?.first_name}} {{file?.data?.updatedBy?.last_name}}
        </div>
        <div class="col-3">
          <p class="mb-1">Updated At:</p>
        </div>
        <div class="col-3 fw-bold">
          {{datePipe.transform(file?.data?.updatedAt, 'dd/MM/yyyy')}}
        </div>
      </div>
    </div>
  </div>

  <div class="card mb-3">
    <div class="card-body">
      <app-google-ad [adSlot]="7950278870" [adFormat]="'auto'"></app-google-ad>
    </div>
  </div>

  <footer dir="ltr">
    <div class="row g-0 justify-content-between fs--1 mt-4 mb-3">
      <div class="col-12 col-sm-auto text-center">
        <p class="mb-1 text-600 text-start">
          Contact Us:
          <br>
          <a>E.mail: <span class="fw-bold">pharmacia2006@gmail.com</span></a>
          <br>
          <a href="http://www.facebook.com/Pharmaciax">http://www.facebook.com/Pharmaciax</a>
        </p>
      </div>
    </div>
  </footer>
</div>

<style>
  @media (max-width: 768px) {
    .container-fluid {
      padding: 10px;
    }

    .card {
      margin-bottom: 1rem;
    }

    .card-body {
      padding: 1rem;
    }

    .row {
      margin-bottom: 16px;
      padding: 8px 0;
    }

    .row:last-child {
      margin-bottom: 0;
    }

    .btn {
      width: 100%;
      margin-bottom: 0.5rem;
    }

    .mb-1 {
      white-space: nowrap;
      margin-bottom: 0 !important;
    }

    .category-row {
      flex-direction: column;
    }

    .category-row>div {
      width: 100%;
      margin-bottom: 0.5rem;
    }

    .category-row .col-3 {
      flex: 0 0 100%;
      max-width: 100%;
    }

    .category-row .label {
      width: 40%;
      display: inline-block;
    }

    .category-row .value {
      width: 60%;
      display: inline-block;
    }
  }
</style>